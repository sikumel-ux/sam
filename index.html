<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>MOYA App</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="style.css"> </head>
<body>

<div class="app-container">
  <header class="header">
    <h1 class="moya-logo">MOYA</h1>
    <p class="tagline">dari mata air pegunungan turi</p>
  </header>

  <div class="content">
    <section id="kas" class="page active">
      <div class="card">
        <h3 style="color:var(--deep); margin-top:0;"><i class="fas fa-wallet"></i> KAS MOYA</h3>
        
        <span class="label">Tanggal Transaksi</span>
        <input type="date" id="k-tgl">
        
        <span class="label">Aliran Dana</span>
        <div class="type-box">
          <button onclick="setType('Masuk')" id="b-masuk" class="btn-type active">MASUK</button>
          <button onclick="setType('Keluar')" id="b-keluar" class="btn-type">KELUAR</button>
        </div>

        <span class="label">Nominal (Rp)</span>
        <input type="number" id="k-amt" placeholder="Masukkan angka...">
        
        <span class="label">Keterangan</span>
        <textarea id="k-desc" placeholder="Contoh: Penjualan 20 Galon"></textarea>
        
        <button onclick="sendData('KAS')" id="btn-kas" class="btn-main">SIMPAN DATA</button>
      </div>
    </section>

    <section id="pelanggan" class="page">
      <div class="card">
        <h3 style="color:var(--deep); margin-top:0;"><i class="fas fa-users"></i> Registrasi Pelanggan</h3>
        <span class="label">Nama Lengkap</span>
        <input type="text" id="p-nama" placeholder="Input nama...">
        <span class="label">Nomor WhatsApp</span>
        <input type="tel" id="p-wa" placeholder="08xxxxxxxx">
        <button onclick="sendData('Pelanggan')" id="btn-cust" class="btn-main">TAMBAH PELANGGAN</button>
      </div>
    </section>
  </div>

  <nav>
    <button onclick="nav('kas', this)" class="nav-btn active">
      <i class="fas fa-home"></i><span>Beranda</span>
    </button>
    <button onclick="nav('pelanggan', this)" class="nav-btn">
      <i class="fas fa-user-friends"></i><span>Pelanggan</span>
    </button>
  </nav>
</div>

<script>
  const WEB_APP_URL = "URL_GAS_WEB_APP_LO"; // Pastikan sudah diganti!
  let currentType = 'Masuk';
  document.getElementById('k-tgl').valueAsDate = new Date();

  function nav(id, el) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    el.classList.add('active');
  }

  function setType(t) {
    currentType = t;
    document.getElementById('b-masuk').classList.toggle('active', t === 'Masuk');
    document.getElementById('b-keluar').classList.toggle('active', t === 'Keluar');
  }

  async function sendData(target) {
    const btn = event.target;
    let payload = { sheet: target, data: [] };

    if(target === 'KAS') {
      const amt = document.getElementById('k-amt').value;
      if(!amt) return alert("Isi nominalnya dulu!");
      payload.data = [document.getElementById('k-tgl').value, currentType, amt, document.getElementById('k-desc').value, new Date()];
    } else {
      const nama = document.getElementById('p-nama').value;
      if(!nama) return alert("Nama jangan kosong!");
      payload.data = [nama, document.getElementById('p-wa').value, new Date()];
    }

    btn.disabled = true; btn.innerText = "SEDANG MENYIMPAN...";

    try {
      await fetch(WEB_APP_URL, {
        method: 'POST',
        mode: 'no-cors',
        body: JSON.stringify(payload)
      });
      alert("Berhasil! Data " + target + " MOYA sudah masuk.");
      if(target === 'KAS') { document.getElementById('k-amt').value = ''; document.getElementById('k-desc').value = ''; }
      else { document.getElementById('p-nama').value = ''; document.getElementById('p-wa').value = ''; }
    } catch (e) {
      alert("Error: " + e.toString());
    } finally {
      btn.disabled = false; btn.innerText = "SIMPAN DATA";
    }
  }
</script>
</body>
</html>
